# üõ†Ô∏è Windows API Functions for Pentesters & Red Teamers
---

<p align="center">
  <img width="750" height="425" alt="Screenshot 2025-08-04 at 6 34 55 PM" src="https://github.com/user-attachments/assets/8550977b-a72c-41f8-bd44-e3a2c1adf574" />
</p>

---

<p align="center">
  <img width="728" height="708" alt="Screenshot 2025-08-04 at 6 35 15 PM" src="https://github.com/user-attachments/assets/31a1d3e2-3e47-483f-b541-6057759d6b9c" />
</p>

---

<p align="center">
  <img width="861" height="410" alt="Screenshot 2025-08-04 at 6 35 40 PM" src="https://github.com/user-attachments/assets/2daa5468-4fbb-4a0d-ab4e-d91b537dd9ac" />
</p>

---

<p align="center">
  <img width="918" height="774" alt="Screenshot 2025-08-04 at 6 36 02 PM" src="https://github.com/user-attachments/assets/9bc87e60-b0df-4c48-89ba-db31d54ca73e" />
</p>

---

<p align="center">
  <img width="917" height="570" alt="Screenshot 2025-08-04 at 6 36 31 PM" src="https://github.com/user-attachments/assets/271fb655-f3ce-413b-a6bc-772eeb720bdd" />
</p>

---


## Example 1: MessageBoxW ‚Äî Show a Windows Message Box
---

```c++
#include <Windows.h>  // Required for Windows API functions

int main() {
    MessageBoxW(
        NULL,                          // hWnd: No owner window (NULL)
        L"Hello from Lock On!",         // lpText: The message body
        L"MessageBox Title",           // lpCaption: The title of the window
        MB_OK | MB_ICONINFORMATION     // uType: Button style and icon type
    );
    return 0;
}
```


<img width="1157" height="694" alt="Screenshot 2025-08-04 at 7 08 36 PM" src="https://github.com/user-attachments/assets/2a53a367-836d-460c-9b83-3d01211afe03" />

---

## Example 2: CreateProcessW ‚Äî Launch an Executable (Notepad)

```c++
#include <Windows.h>
#include <iostream>

int main() {
    STARTUPINFOW si = { 0 };           // Startup configuration struct
    PROCESS_INFORMATION pi = { 0 };    // Receives info about the created process

    si.cb = sizeof(si);  // Required: set the size of the structure

    LPCWSTR appName = L"C:\\Windows\\System32\\notepad.exe";  // Program to run

    // Attempt to create the new process
    BOOL success = CreateProcessW(
        appName,        // Application name
        NULL,           // Command line (optional)
        NULL,           // Process security attributes
        NULL,           // Thread security attributes
        FALSE,          // Inherit handles?
        0,              // Creation flags
        NULL,           // Environment (inherit from parent)
        NULL,           // Current directory (use parent‚Äôs)
        &si,            // Pointer to STARTUPINFOW structure
        &pi             // Pointer to PROCESS_INFORMATION structure
    );

    if (success) {
        std::wcout << L"Process created. PID: " << pi.dwProcessId << std::endl;

        // Optionally wait for the process to exit
        WaitForSingleObject(pi.hProcess, INFINITE);

        // Clean up handles
        CloseHandle(pi.hProcess);
        CloseHandle(pi.hThread);
    } else {
        std::wcerr << L"Failed to create process. Error: " << GetLastError() << std::endl;
    }

    return 0;
}
```

<img width="1163" height="699" alt="Screenshot 2025-08-04 at 7 15 02 PM" src="https://github.com/user-attachments/assets/fdb870f1-e5b2-4b1e-b68c-727f5fe89af4" />


---



## Example 3: NtQueryInformationProcess - Getting the PEB and Parent PID

```cpp
#include <Windows.h>
#include <winternl.h>
#include <iostream>

// Define a custom struct to avoid conflict with SDK
typedef struct _MY_PROCESS_BASIC_INFORMATION {
    PVOID Reserved1;
    PPEB PebBaseAddress;
    PVOID Reserved2[2];
    ULONG_PTR UniqueProcessId;
    ULONG_PTR InheritedFromUniqueProcessId;
} MY_PROCESS_BASIC_INFORMATION;

// Function pointer to NtQueryInformationProcess
typedef NTSTATUS(NTAPI* NtQueryInformationProcess_t)(
    HANDLE,
    PROCESSINFOCLASS,
    PVOID,
    ULONG,
    PULONG
    );

int main() {
    DWORD pid = GetCurrentProcessId();
    HANDLE hProcess = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, pid);

    if (!hProcess) {
        std::cerr << "Failed to open process. Error: " << GetLastError() << std::endl;
        return 1;
    }

    // Resolve NtQueryInformationProcess from ntdll
    HMODULE hNtdll = GetModuleHandleW(L"ntdll.dll");
    NtQueryInformationProcess_t NtQueryInformationProcess =
        (NtQueryInformationProcess_t)GetProcAddress(hNtdll, "NtQueryInformationProcess");

    if (!NtQueryInformationProcess) {
        std::cerr << "Could not resolve NtQueryInformationProcess" << std::endl;
        CloseHandle(hProcess);
        return 1;
    }

    MY_PROCESS_BASIC_INFORMATION pbi = {};
    ULONG returnLength = 0;

    NTSTATUS status = NtQueryInformationProcess(
        hProcess,
        ProcessBasicInformation,
        &pbi,
        sizeof(pbi),
        &returnLength
    );

    if (status == 0) {
        std::cout << "PEB Address: " << pbi.PebBaseAddress << std::endl;
        std::cout << "Parent PID : " << pbi.InheritedFromUniqueProcessId << std::endl;
    }
    else {
        std::cerr << "NtQueryInformationProcess failed. NTSTATUS: 0x" << std::hex << status << std::endl;
    }

    CloseHandle(hProcess);
    return 0;
}
```

---



<img width="1163" height="699" alt="nt" src="https://github.com/user-attachments/assets/1c01f870-98f6-4ab1-8753-7a6381592796" />


---

## Example 4: IsDebuggerPresent

```cpp
#include <Windows.h>
#include <iostream>

int main() {
    if (IsDebuggerPresent()) {
        std::cout << "Debugger detected. Exiting..." << std::endl;
        return 1;
    } else {
        std::cout << "No debugger detected. Continuing execution." << std::endl;
    }

    // Proceed with normal execution...
    return 0;
}

```

---

<img width="1163" height="699" alt="debug" src="https://github.com/user-attachments/assets/d8c675e6-531e-4be6-9fb3-ca447d107d0e" />

---








