# üõ†Ô∏è Windows API Functions for Pentesters & Red Teamers


---

Process & Thread Manipulation
API Function	Purpose
CreateProcess / CreateProcessW	Spawns a new process
OpenProcess	Gets a handle to a target process
GetCurrentProcessId / GetCurrentThreadId	Returns current PID or TID
VirtualAllocEx	Allocates memory in a remote process
WriteProcessMemory	Writes shellcode or DLL path into a remote process
CreateRemoteThread	Starts a thread in another process (classic injection)
NtCreateThreadEx	Low-level thread creation (often bypasses hooks)
QueueUserAPC	Schedules APC payload in a remote thread
SuspendThread / ResumeThread	Used in process hollowing / thread hijacking
Token & Privilege Manipulation
API Function	Purpose
OpenProcessToken	Retrieves a handle to a process's access token
LookupPrivilegeValue	Gets the LUID for a privilege
AdjustTokenPrivileges	Enables or disables privileges (e.g., SeDebugPrivilege)
ImpersonateLoggedOnUser	Runs code under another user‚Äôs security context
DuplicateTokenEx	Clones an existing token
LogonUser	Authenticates a user and returns a token (useful for pivoting)
Memory & DLL Injection
API Function	Purpose
LoadLibraryA / LoadLibraryW	Loads a DLL into the calling process
GetProcAddress	Resolves function pointers
LdrLoadDll (ntdll)	Manual DLL loading (stealthy)
NtMapViewOfSection	Used in process hollowing / mapping PE in memory
NtUnmapViewOfSection	Used before remapping a new image
RtlCreateUserThread	Alternative to CreateRemoteThread
SetThreadContext / GetThreadContext	Used in classic hollowing and injection 
tricks
Stealth & Anti-EDR
API Function	Purpose
NtQueryInformationProcess	Leak process info like PEB, command line
NtProtectVirtualMemory	Change memory permissions (for unhooking)
NtReadVirtualMemory / NtWriteVirtualMemory	Low-level memory access
EnumProcesses / CreateToolhelp32Snapshot	Process enumeration
VirtualQueryEx	Checks memory layout of another process
ReadProcessMemory	Reads target memory (for parsing shellcode, etc.)
GetModuleHandle	Grabs a loaded DLL‚Äôs base address
GetThreadStartAddress (via NtQueryInformationThread)	Used to detect or hijack 
thread execution
System & User Recon
API Function	Purpose
NetUserEnum / NetUserGetInfo	Enumerate local/domain users
GetUserName / GetUserNameEx	Gets current user info
NetLocalGroupEnum	Lists local groups
NetSessionEnum	Lists active sessions
WNetEnumResource	Lists shared network resources
GetComputerName	Gets the hostname
GetAdaptersInfo / GetIpAddrTable	Network enumeration
EnumServicesStatusEx	Lists services and their state
RegOpenKeyEx / RegQueryValueEx	Registry access (common in persistence)
Credential Dumping
API Function	Purpose
LSAGetLogonSessionData	Dump session info from LSASS
LsaEnumerateLogonSessions	Get list of user sessions
LsaRetrievePrivateData	Extract sensitive LSA secrets (requires 
SeTrustedCredManAccessPrivilege)
CryptUnprotectData	Decrypt DPAPI secrets (Chrome creds, etc.)
OpenProcess + ReadProcessMemory	For dumping LSASS manually
MiniDumpWriteDump	Used to dump LSASS memory with debugging privileges
Persistence / Service Abuse
API Function	Purpose
CreateService / StartService	Abuse for persistence or privilege escalation
ChangeServiceConfig	Modify existing services
RegisterScheduledTask	Create scheduled task persistence
RegSetValueEx	Registry-based persistence
ShellExecuteEx / WinExec	Execute commands through COM/Shell
Uncommon/Stealthier NT Native Functions
API Function	Notes
NtCreateSection	Used in hollowing/mapping payloads
NtSetContextThread	Control thread context (stealthy injection)
NtOpenThreadToken	Stealthy token access
NtCreateUserProcess	Alternative to CreateProcess, used in manual mapping
